# Remote Procedure Calls (RPC)
---
[Go Back](../README.md)

---
## Local Calls vs. Remote Calls
- **Local calls**
	- One single process
	- Can pass args by reference
- **Remote calls**
	- Two processes (Caller and called).
	- Requires to locate the remote machine.
	- Requires to check types existence (and coherence).
	- Cannot pass arguments by reference.
---
## Stubs
- Are the functions for interaction at the message level.
- **Client stub**: Sends parameters and waits for the response.
- **Server stub**: Waits for connection, reads message, invokes function, and sends result.
---
## RPC Implementation (XDR)
- Both client and server will implement `myProgram.h` generated with `rpcgen`
- Client will be compiled with `myProgram_clnt.c`
- Server will be compiled with `myProgram_srv.c`
```C
// File: myProgram.x
struct MyParams
{
	int a;
	int b;
};
typedef int MyReturn;

program MY_PROGRAM
{
	version BETA 
	{
		MyReturn myFunction(MyParams ab) = 1; // ID = 1
		MyReturn myOFunction2(MyParams ab) = 2; // ID = 1
	}
	= 17; // Version ID for BETA
}
= 0x40008001; // Server ID for MY_PROGRAM
```

```C
// File: server.c
#include "myProgram.h"

// Defines the function (args and return by reference to static variable)
// Always receives struct svc_req pointer
MyReturn *myFunction1_17_srv(Operand *data, struct svc_req *r)
{
	
}
```

```C
// File: server.c
struct MyParams
{
	int a;
	int b;
};
typedef int MyReturn;

program MY_PROGRAM
{
	version BETA 
	{
		MyReturn myFunction1(MyParams ab) = 1; // ID = 1
		MyReturn myFunction2(MyParams ab) = 2; // ID = 1
	}
	= 17; // Version ID for BETA
}
= 0x40008001; // Server ID for MY_PROGRAM
```

**Asynchronous RPCs:**
- Allows the client to continue working without waiting for the response.

**Problems and Solutions in ONC RPC:**
- **Parameter coding**: Using XDR.
- **Interface specification**: Using IDL.
- **Service location**: Using portmapper.
- **Code generation**: Using rpcgen.

**Interface Specification:**
- Specified in a specific language (.x file), declaring parameters, result types, and services offered by RPC.

**Java RMI (Remote Method Invocation):**
- Object-oriented equivalent of RPC.
- Remote classes implement methods, with stubs and skeletons handling communication.
- Requires a registry for client-server connection.

This document provides detailed examples and pseudocode for implementing and understanding RPC and Java RMI in distributed systems.